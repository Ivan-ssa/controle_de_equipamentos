<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Equipamentos</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header class="main-header">
        <h1>Dashboard de Equipamentos 4</h1>
    </header>

    <main class="container">
        <section class="controls-section">
            <div class="file-input-container">
                <input type="file" id="excelFileInput" accept=".xlsx, .xls, .csv, .xlsm">
                <button id="processButton" class="action-button">Processar Arquivo</button>
            </div>
            <div class="section-toggle">
                <button id="showEquipmentButton" class="toggle-section-button active">Equipamentos</button>
                <button id="showOsButton" class="toggle-section-button">OS em Aberto</button>
                <button id="showDivergenceButton" class="toggle-section-button">Ver Divergências</button>
                <button id="showRondaButton" class="toggle-section-button">Ronda</button>
                
            </div>
        </section>

        <div id="output" class="output-message">Aguardando arquivo...</div>

        <section id="equipmentSection" class="table-section">
            <h2>Equipamentos Cadastrados <span id="equipmentCount">Total: 0 equipamentos</span></h2>
            <div id="filterContainer">
                <select id="sectorFilter"><option value="">Todos os Setores</option></select>
                <select id="calibrationStatusFilter"><option value="">Status da Calibração</option></select>
                <select id="maintenanceFilter">
                    <option value="">Todos os Status de Manutenção</option>
                    <option value="manutencao_sim">Em Manutenção Externa</option>
                    <option value="manutencao_nao">Não em Manutenção Externa</option>
                </select>
                <input type="text" id="searchInput" placeholder="Buscar por SN/Patrimônio/TAG...">
            </div>
            <div class="table-wrapper">
                <table id="equipmentTable" class="styled-table">
                    <thead>
                        <tr class="table-headers-row">
                            <th>TAG</th><th>Equipamento</th><th>Modelo</th><th>Fabricante</th>
                            <th>Setor</th><th>Nº Série</th><th>Patrimônio</th><th>Fornecedor</th>
                            <th>Data Calibração</th><th>Data Vencimento Calibração</th>
                        </tr>
                        <tr id="headerFilters"></tr>
                    </thead>
                    <tbody id="equipmentTableBody"></tbody>
                </table>
            </div>
            <button id="exportButton" class="export-button">Exportar Equipamentos (Excel)</button>
        </section>
        
        <section id="osSection" class="table-section hidden">
            <h2>Ordens de Serviço em Aberto <span id="osCount">Total: 0 OS</span></h2>
            <button id="exportOsButton" class="export-button">Exportar OS (Excel)</button>
            <div class="table-wrapper">
                <table id="osTable" class="styled-table">
                    <thead>
                        <tr>
                            <th>OS</th>
                            <th>Patrimônio</th>
                            <th>Nº Série</th>
                            <th>Equipamento</th>
                            <th>Modelo</th>
                            <th>Fabricante</th>
                            <th>Setor</th>
                        </tr>
                    </thead>
                    <tbody id="osTableBody"></tbody>
                </table>
            </div>
        </section>

        <section id="divergenceSection" class="table-section hidden">
            <h2>Equipamentos com Divergência <span id="divergenceCount">Total: 0 divergências</span></h2>
            <div class="table-wrapper">
                <table id="divergenceTable" class="styled-table">
                    <thead>
                        <tr>
                            <th>Nº Série</th>
                            <th>Fornecedor</th>
                            <th>Data Calibração</th>
                        </tr>
                    </thead>
                    <tbody id="divergenceTableBody"></tbody>
                </table>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Dashboard de Equipamentos</p>
    </footer>

    <!-- Bibliotecas para Excel -->
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
    <script type="module" src="js/main.js"></script>
</body>
</html>